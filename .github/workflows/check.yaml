name: PR Title Check

on:
  pull_request:
    branches: [main, develop] # Or your target branches

jobs:
  check_title:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Check PR title
        id: check_title # Assign an ID to the step
        run: |
          PR_TITLE="${{ github.event.pull_request.title }}"
          echo "PR Title: ${PR_TITLE}"

          # Regular expression to match the expected format
          REGEX="^(GSA|CNME|MA)-\\d+ - .+"

          if [[ ! "${PR_TITLE}" =~ $REGEX ]]; then
            echo "::error::PR title '${PR_TITLE}' does not match the required format (GSA|CNME|MA)-XXXX - Description."
            exit 1 # Fail the workflow
          else
            echo "::notice::PR title '${PR_TITLE}' matches the required format."
          fi

      - name: Output Result
        if: always() # Always run this step
        run: |
          if steps.check_title.outcome == 'failure'; then
            echo "PR Title Check Failed"
          else
            echo "PR Title Check Passed"
          fi
